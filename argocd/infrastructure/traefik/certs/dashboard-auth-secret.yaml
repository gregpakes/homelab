apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: traefik-dashboard-basic-auth
  namespace: traefik
spec:
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: onepassword-connect
  target:
    name: traefik-dashboard-basic-auth
    creationPolicy: Owner
    template:
      type: Opaque
      data:
        # Traefikâ€™s basicAuth middleware expects key "users" with htpasswd lines
        users: "{{ .users }}"
  data:
    - secretKey: users
      remoteRef:
        key: traefik-dashboard-basic-auth     # 1Password item name
        property: users                       # field inside the item
        # optional: set a specific vault if your store isn't pinned to one
        # metadata:
        #   vault: Kubernetes